---
title: "SuperBowl Ads"
subtitle: "Presentation subtitle (if any)"
author: "Dorian's Gs <br> Courtney Lee, Eli Feder, Parker Dingman, Martha Aboagye"
institute: "Duke University"
date: "`r Sys.Date()`"
output:
  xaringan::moon_reader:
    css:  xaringan-themer.css
    lib_dir: libs
    nature:
      ratio: "16:9"
      highlightStyle: github
      highlightLines: true
      countIncrementalSlides: false
---

```{r load-packages, include = FALSE}
# Add any additional packages you need to this chunk
# Remove any packages from this list that you're not using
library(tidyverse)
library(tidymodels)
library(palmerpenguins)
library(knitr)
library(xaringanthemer)
library(ggeasy)

#library(reshape2)
```

```{r setup, include=FALSE}
# For better figure resolution
knitr::opts_chunk$set(
  fig.retina = 3, 
  dpi = 300, 
  fig.width = 6, 
  fig.asp = 0.618, 
  out.width = "70%"
  )
```

```{r load-data, include=FALSE}
superbowl <- readr::read_csv(
  'https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2021/2021-03-02/youtube.csv')
```

```{r style-slides, echo = FALSE}
style_xaringan(
  title_slide_background_image = "img/watercolour_sys02_img34_teacup-ocean.jpg"
)
```

class: inverse, middle, center

# Characteristics Of The Most Viewed Ads

---

class: inverse, middle, center

## What factors contribute to the most viewed ads and  has the relationship between those factors and the views changed over time?

---

## Approach

The relevant variables are all numerical and include:
`view_count`, `like_count`, `dislike_count`, `comment_count`, and `favorite count`. 

--
- The `view_count` is the measure for popularity, while the other variables define interaction with the ad
  

---

## Layouts

You can use plain text

- or bullet points

.pull-left[
or text in two columns $^*$
]
.pull-right[
- like
- this
]

.footnote[
[*] And add footnotes
]

---

## Code

```{r boring-regression}
# a boring regression
model <- lm(dist ~ speed, data = cars)
tidy(model)
glance(model)
```

```{r create-superbowl-viz-data}
#transformed dataset that can be used to make visualizations
# superbowl_viz_data <- superbowl %>%
#   select(year, view_count, animals, celebrity, use_sex) %>%
#   group_by(animals, year) %>%
#   mutate(average_view_count_animals = sum(view_count, na.rm = TRUE) / n()) %>%
#   ungroup() %>%
#   group_by(celebrity, year) %>%
#   mutate(average_view_count_celebrity = sum(view_count, na.rm = TRUE) / n()) %>%
#   ungroup() %>%
#   group_by(use_sex, year) %>%
#   mutate(average_view_count_use_sex = sum(view_count, na.rm = TRUE) / n()) %>%
#   ungroup() %>%
#   select(-view_count) %>%
#   select(year, animals, average_view_count_animals,
#          celebrity, average_view_count_celebrity,
#          use_sex, average_view_count_use_sex)
# 
# superbowl_viz_data <- superbowl_viz_data[!duplicated(superbowl_viz_data), ]
# 
# superbowl_plot <- superbowl_viz_data %>%
#   mutate(avg_vc_ani_TRUE
#          = case_when(animals == TRUE ~ average_view_count_animals)) %>%
#   mutate(avg_vc_ani_FALSE
#          = case_when(animals == FALSE ~ average_view_count_animals)) %>%
#   mutate(avg_vc_cel_TRUE
#          = case_when(celebrity == TRUE ~ average_view_count_celebrity)) %>%
#   mutate(avg_vc_cel_FALSE
#          = case_when(celebrity == FALSE ~ average_view_count_celebrity)) %>%
#   mutate(avg_vc_sex_TRUE
#          = case_when(use_sex == TRUE ~ average_view_count_use_sex)) %>%
#   mutate(avg_vc_sex_FALSE
#          = case_when(use_sex == FALSE ~ average_view_count_use_sex)) %>%
#   select(year, avg_vc_ani_TRUE, avg_vc_ani_FALSE,
#                avg_vc_cel_TRUE, avg_vc_cel_FALSE,
#                avg_vc_sex_TRUE, avg_vc_sex_FALSE)
# 
# superbowl_plot_long <- melt(superbowl_plot, id = "year",
#                            measure = c("avg_vc_ani_TRUE", "avg_vc_ani_FALSE",
#                                        "avg_vc_cel_TRUE", "avg_vc_cel_FALSE",
#                                        "avg_vc_sex_TRUE", "avg_vc_sex_FALSE"))
# 
# superbowl_plot_long <- superbowl_plot_long[!duplicated(superbowl_plot_long), ]
# superbowl_plot_long <- superbowl_plot_long %>%
#   na.omit() %>%
#   filter(value != 0)
```

```{r}
# superbowl_animals <- superbowl %>%
#   select(view_count, animals, year) %>%
#   filter(!is.na(view_count)) %>%
#   group_by(animals, year) %>%
#   mutate(average_view_count = sum(view_count) / n(),
#          total_view_count = sum(view_count),
#          total_ads = n())%>%
#   ungroup() %>%
#   select(-view_count)
# 
# superbowl_animals <- superbowl_animals[!duplicated(superbowl_animals), ]
# superbowl_animals<- rename(superbowl_animals, 'have' = 'animals')
# superbowl_animals$variable <- 'animals'
# 
# 
# superbowl_celebrity <- superbowl %>%
#   select(view_count, celebrity, year) %>%
#   filter(!is.na(view_count)) %>%
#   group_by(celebrity, year) %>%
#   mutate(average_view_count = sum(view_count) / n(),
#          total_view_count = sum(view_count),
#          total_ads = n())%>%
#   ungroup() %>%
#   select(-view_count)
# 
# superbowl_celebrity <- superbowl_celebrity[!duplicated(superbowl_celebrity), ]
# superbowl_celebrity<- rename(superbowl_celebrity, 'have' = 'celebrity')
# superbowl_celebrity$variable <- 'celebrity'
# 
# 
# superbowl_use_sex <- superbowl %>%
#   select(view_count, use_sex, year) %>%
#   filter(!is.na(view_count)) %>%
#   group_by(use_sex, year) %>%
#   mutate(average_view_count = sum(view_count) / n(),
#          total_view_count = sum(view_count),
#          total_ads = n())%>%
#   ungroup() %>%
#   select(-view_count)
# 
# superbowl_use_sex <- superbowl_use_sex[!duplicated(superbowl_use_sex), ]
# superbowl_use_sex<- rename(superbowl_use_sex, 'have' = 'use_sex')
# superbowl_use_sex$variable <- 'use_sex'
# 
# superbowl_viz <- rbind(superbowl_animals, superbowl_celebrity, superbowl_use_sex)
# superbowl_viz <- superbowl_viz %>% relocate(variable, .before = have)
```


---

## Plots (Q1 Plot 1)

```{r recode-species, echo = FALSE}
# In this chunk I'm doing a bunch of analysis that I don't want to present 
# in my slides. But I need the resulting data frame for a plot I want to present.
penguins_modified <- penguins %>%
  mutate(species = fct_other(species, keep = "Adelie"))
```

```{r plot-penguins, echo = FALSE, warning = FALSE, fig.alt = "Body mass vs. flipper lenght of Palmer Penguins for species Adelie and all the others combined together. There is a relatively strong, positive relationship between the two variables. The Adelie penguins are clustered together but they don't exhibit a different trend than the rest of the penguins."}
# Code hidden with echo = FALSE
# Uses modified penguins dataset from previous chunk
# Play around with height and width until you're happy with the look
ggplot(penguins_modified, aes(x = flipper_length_mm, y = body_mass_g, color = species)) +
  geom_point() + 
  theme_minimal()
```

```{r}
superbowl_viz <- superbowl %>%
  select(year, view_count, animals, celebrity, use_sex) %>%
  filter(!is.na(view_count)) %>%
  pivot_longer(cols = c(animals, celebrity, use_sex), names_to = 'variable', values_to = 'have') %>%
  group_by(variable, have, year) %>%
  summarise(total_vc = sum(view_count),
            total_ads = n(),
            average_vc = total_vc / total_ads) %>% 
  relocate(average_vc, .before = total_vc) %>%
  mutate(variable = case_when(variable == "animals" ~ "Animal",
                           variable == "celebrity" ~ "Celebrity",
                           variable == "use_sex" ~ "Sexual"))
  

```



```{r Q1-plot-1}

superbowl_viz %>%
  select(-year, -average_vc) %>%
  group_by(variable, have)  %>%
  summarise (aggregate_vc = sum(total_vc),
            aggregate_ads = n(),
            average_vc = aggregate_vc / aggregate_ads) %>% 
  relocate(average_vc, .before = aggregate_vc) %>%
  ggplot(aes(variable, average_vc, fill = have)) +
  geom_bar(stat = "identity", position = "dodge") + 
  scale_fill_manual(values = c("#D2222D", "darkgreen"), 
                    guide = guide_legend(reverse = TRUE)) + 
  scale_y_continuous(labels = comma) +
  labs(title = "Advertisement Views by Category",
       x = "Category", y = "Average View Count") +
  theme_minimal() +
  easy_center_title() 
      
```





---

## Plots (Q1 Plot 2)

```{r}
superbowl_viz %>%
ggplot(aes(year, average_vc, color = variable)) + 
  geom_line() + 
  coord_cartesian(ylim  = c(0, 2e+06)) + 
  scale_color_manual(
    values = c(Animal = "#E69F00", Celebrity = "#56B4E9", Sexual = "#009E73"))+
  theme_minimal() + 
  labs(y = "Average View Count", 
       x = "Year",
       color = "Ad Type") 
```

---

## Plot and text

.pull-left[
- Some text
- goes here
]
.pull-right[
```{r warning=FALSE, out.width="100%", fig.width=4, echo=FALSE}
# see how I changed out.width and fig.width from defaults
# to make the figure bigger
ggplot(penguins, aes(x = bill_length_mm, y = species, color = species)) +
  geom_boxplot() +
  theme_minimal()
```
]

---

class: inverse, middle, center

# A new section...

---

## Tables

If you want to generate a table, make sure it is in the HTML format (instead of Markdown or other formats), e.g.,

```{r penguins-table, echo = FALSE}
kable(head(penguins), format = "html")
```

---

## Images

```{r castle, echo = FALSE, out.width = "40%", fig.align = "center", fig.cap = "Image credit: Danielle Navarro, Percolate."}
include_graphics("img/watercolour_sys02_img32_percolate.jpg")
```

Or you can also include a full page image. See next slide.

---

background-image: url(img/watercolour_sys02_img32_percolate.jpg)

---

## Math Expressions

You can write LaTeX math expressions inside a pair of dollar signs, e.g. &#36;\alpha+\beta$ renders $\alpha+\beta$. You can use the display style with double dollar signs:

```
$$\bar{X}=\frac{1}{n}\sum_{i=1}^nX_i$$
```

$$\bar{X}=\frac{1}{n}\sum_{i=1}^nX_i$$

Limitations:

1. The source code of a LaTeX math expression must be in one line, unless it is inside a pair of double dollar signs, in which case the starting `$$` must appear in the very beginning of a line, followed immediately by a non-space character, and the ending `$$` must be at the end of a line, led by a non-space character;

1. There should not be spaces after the opening `$` or before the closing `$`.

1. Math does not work on the title slide (see [#61](https://github.com/yihui/xaringan/issues/61) for a workaround).

---

class: inverse, middle, center

# Wrap up

---

## Feeling adventurous?

- Want to find out more about `xaringan`? See https://slides.yihui.name/xaringan/#1.

- You are welcomed to use the default styling of the slides. In fact, that's what I expect majority of you will do. You will differentiate yourself with the content of your presentation.

- But some of you might want to play around with slide styling. The 
`xaringanthemer` provides some solutions for this that: https://pkg.garrickadenbuie.com/xaringanthemer.

- And if you want more bells and whistles, there is also `xaringanExtra`: https://pkg.garrickadenbuie.com/xaringanExtra.
