---
title: "SuperBowl Ads"
author: "Dorian's Gs <br> Martha Aboagye, Parker Dingman, Eli Feder, Courtney Lee"
institute: "Duke University"
date: "`r Sys.Date()`"
output:
  xaringan::moon_reader:
    css:  xaringan-themer.css
    lib_dir: libs
    nature:
      ratio: "16:9"
      highlightStyle: github
      highlightLines: true
      countIncrementalSlides: false
---

```{r load-packages, include = FALSE}
library(ggplot2)
library(tidyverse)
library(tidymodels)
library(knitr)
library(xaringanthemer)
library(fs)
library(dplyr)
library(ggridges)
library(forcats)
library(scales)
library(viridis)
library(tagger)
library(colorspace)
```

```{r setup, include=FALSE}
knitr::opts_chunk$set(
  fig.width = 30, 
  fig.height = 17,
  fig.align = "center"
  )
```

```{r load-data, include=FALSE}
superbowl <- readr::read_csv(
  'https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2021/2021-03-02/youtube.csv')
```

```{r style-slides, echo = FALSE}
style_xaringan(
  title_slide_background_image = "img/darksuperbowl.jpg"
)
```

class: inverse, middle, center

background-image: url(img/superbowlads.png)

---

## 1. What factors contribute to the most viewed ads and has the relationship between those factors and the views changed over time?

--

- Talk about specific categories here

---

## 2. What is the relationship between popularity of a Superbowl Ad and how well it is interacted with?

--

- Examining the relationship between different popularity and interaction metrics

--

- Popularity: view count
- Interactions: comments, likes, and dislikes
- Grouped `view_count` into categories due to outliers

---

```{r density_analysis, echo = FALSE, warning = FALSE, message = FALSE}
superbowl <- superbowl %>%
  mutate(ratio = like_count / (like_count + dislike_count),
         interactions = like_count + dislike_count + comment_count,
         view_category = case_when(
            view_count < 4000 ~ "Few",
            view_count >= 4000 & view_count < 30000 ~ "Some",
            view_count >= 30000 & view_count < 90000 ~ "Moderate",
            view_count >= 90000 & view_count < 500000 ~ "Many",
            view_count >= 500000 & view_count < 10000000 ~ "High",
            TRUE ~ "Viral"))
superbowl %>%
  mutate(Views = fct_relevel(
            view_category, "Few", "Some", "Moderate", "Many","High","Viral"
         )) %>%
  ggplot(aes(x = ratio, y = Views, fill = Views)) +
    geom_density_ridges(scale = 0.9, show.legend = TRUE) +
    coord_cartesian(xlim = c(0.5, 1.0)) +
    scale_fill_discrete_sequential(palette = "Greens", order = c(1:6),
                                  labels = c("Less than 4K", "4K to 30K", "30K to 90K", 
                                             "90K to 500K", "500K to 10M", "10M+"),
                                  guide = guide_legend(reverse = TRUE)) +
    scale_x_continuous(expand = c(0, 0.1), labels = scales::percent_format(accuracy = 1)) +
    scale_y_discrete(expand = expand_scale(mult = c(0, .2))) +
    labs(
      title = "Youtube Superbowl Ads and Like Percentages",
      x = "Like Percentage",
      y = "Views",
    caption = "Source: FiveThirtyEight") +
    theme_ridges() +
    theme(
      plot.title.position = "plot",
      plot.title = element_text(face = "bold", size = 90, hjust = 0),
      plot.caption = element_text(size = 40, hjust = 1.3),
      legend.key.size = unit(3, 'cm'),
      legend.text = element_text(size = 40),
      legend.title = element_text(size = 50),
      axis.title.x = element_text(face = "bold", size = 70, hjust = 0.42, vjust = -1), 
      axis.title.y = element_text(face = "bold", size = 70, hjust = 0.54, vjust = 1),
      axis.text = element_text(size = 50, lineheight = 10),
      axis.text.x = element_text(vjust = -1))
```

---
```{r set_views, echo = FALSE, message = FALSE, warning = FALSE}
superbowl <- superbowl %>%
  mutate(view_category = paste(view_category, "Views"))
superbowl <- superbowl %>%
  mutate(view_category = fct_relevel(
  view_category, "Few Views","Some Views","Moderate Views","Many Views", "High Views", "Viral Views"))
```


```{r interactions, echo = FALSE, message = FALSE, warning = FALSE}
ggplot(data = superbowl, aes(x = view_count, y = interactions)) +
  geom_area(aes(fill = view_category), show.legend = NULL) +
  geom_line() +
  facet_wrap(vars(view_category),  
             scales ="free",
             nrow = 3,
             strip.position = "top") +
	scale_y_continuous(label = label_number_si()) +
  scale_x_continuous(label = label_number_si()) +
  scale_fill_discrete_sequential(palette = "Blues") +
  labs(x = "View Count", y ="Number of Interactions", title ="Assessing Superbowl Ad Interactions",
       caption ="Interaction is defined by the sum of \nlikes, dislikes and comments on a video")+
  theme_minimal() +
  theme(panel.grid.minor = element_blank(),
        strip.background = element_rect(colour = "black"),
        strip.placement = "inside",
        plot.title = element_text(face = "bold", size = 80, hjust = 0.5, vjust = 1),
        plot.caption = element_text(size = 30, hjust = 0),
        panel.spacing = unit(1.4, "lines"),
        axis.text.x = NULL,
        axis.title.x = element_text(size = 50, vjust = -.5),
        axis.title.y = element_text(size = 50, hjust = 0.5, vjust = 1),
        axis.text = element_text(size = 25, lineheight = 10),
        strip.text.x = element_text(size = 30))
```
---
class: inverse, middle, center

# Questions?
