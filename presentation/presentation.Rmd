---
title: "SuperBowl Ads"
author: "Dorian's Gs <br> Martha Aboagye, Parker Dingman, Eli Feder, Courtney Lee"
institute: "Duke University"
date: "`r Sys.Date()`"
output:
  xaringan::moon_reader:
    css:  xaringan-themer.css
    lib_dir: libs
    nature:
      ratio: "16:9"
      highlightStyle: github
      highlightLines: true
      countIncrementalSlides: false
---

```{r load-packages, include = FALSE}
library(ggplot2)
library(tidyverse)
library(tidymodels)
library(knitr)
library(xaringanthemer)
library(fs)
library(dplyr)
library(ggridges)
library(forcats)
library(scales)
library(viridis)
library(tagger)
library(colorspace)
```

```{r setup, include=FALSE}
knitr::opts_chunk$set(
  fig.retina = 3, 
  dpi = 300, 
  fig.width = 6, 
  fig.asp = 0.618, 
  out.width = "70%"
  )
```

```{r load-data, include=FALSE}
superbowl <- readr::read_csv(
  'https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2021/2021-03-02/youtube.csv')
```

```{r style-slides, echo = FALSE}
style_xaringan(
  title_slide_background_image = "img/darksuperbowl.jpg"
)
```

class: inverse, middle, center

background-image: url(img/superbowlads.jpg)

---

## 1. What factors contribute to the most viewed ads and has the relationship between those factors and the views changed over time?

--

- Talk about specific categories here

---

## Details

You can use plain text

- or bullet points

.pull-left[
or text in two columns $^*$
]
.pull-right[
- like
- this
]

.footnote[
[*] And add footnotes
]

---

## First Plot Name

```{r boring-regression}
# a boring regression
model <- lm(dist ~ speed, data = cars)
tidy(model)
glance(model)
```


---

## 2. What is the relationship between popularity of a Superbowl Ad and how well it is interacted with?

--

- Examining the relationship between different popularity and interaction metrics

--

- Popularity: views
- Interactions: comments, likes, and dislikes

---

```{r density_analysis, echo = FALSE, warning = FALSE, message = FALSE, fig.width = 30, fig.height = 25, fig.align = "center"}
superbowl <- superbowl %>%
  mutate(ratio = like_count / (like_count + dislike_count),
         interactions = like_count + dislike_count + comment_count,
         view_category = case_when(
            view_count < 4000 ~ "Few",
            view_count >= 4000 & view_count < 30000 ~ "Some",
            view_count >= 30000 & view_count < 90000 ~ "Moderate",
            view_count >= 90000 & view_count < 500000 ~ "Many",
            view_count >= 500000 & view_count < 10000000 ~ "High",
            TRUE ~ "Viral"))
superbowl %>%
  mutate(Views = fct_relevel(
            view_category, "Viral", "High", "Many", "Moderate","Some","Few")
         ) %>%
  ggplot(aes(x = ratio, y = Views, fill = Views)) +
    geom_density_ridges(banwidth = 10, scale = 1, show.legend = TRUE) +
    coord_cartesian(xlim = c(0.5, 1.0)) +
    scale_fill_discrete_sequential(palette = "Greens", order = c(6:1),
                                  labels = c("10M+", "500k to 10M", 
                                            "90K to 500K", "30K to 90K", 
                                            "4k to 30K", "Less than 4K")) +
    scale_x_continuous(expand = c(0, 0.1), labels = scales::percent_format(accuracy = 1)) +
    scale_y_discrete(expand = expand_scale(mult = c(0, .3))) +
    labs(
      title = "Youtube Superbowl Ads and Like Percentages",
      x = "Like Percentage",
      y = "Views",
    caption = "Source: FiveThirtyEight") +
    guides(fill = guide_legend(reverse = TRUE)) +
    theme_ridges() +
    theme(
      plot.title.position = "plot",
      plot.title = element_text(face = "bold", size = 90, hjust = 0),
      plot.caption = element_text(size = 40, hjust = 1.3),
      legend.key.size = unit(3, 'cm'),
      legend.text = element_text(size = 40),
      legend.title = element_text(size = 50),
      axis.title.x = element_text(face = "bold", size = 70, hjust = 0, vjust = -1), 
      axis.title.y = element_text(face = "bold", size = 70, hjust = 0, vjust = 1),
      axis.text = element_text(size = 50, lineheight = 10),
      axis.text.x = element_text(vjust = -1))
```

---

```{r interactions, echo = FALSE, warning = FALSE, fig.width = 30, fig.height = 25, fig.align = "center"}
superbowl %>%
  group_by(view_category) %>%
  select(interactions)

superbowl %>%
  group_by(view_category) %>%
  filter(!is.na(interactions)) %>%
  summarise(vti = sum(view_count) / sum(interactions))

superbowl %>%
  mutate(view_category = paste(view_category, "Views")) %>%
   mutate(view_category = fct_relevel(
    view_category, "Few Views","Some Views","Moderate Views","Many Views", "High Views",  "Viral Views" 
  )) %>%
ggplot(aes(x =view_count, y=interactions)) +
  geom_area(aes(fill = view_category, alpha=0.5), show.legend = NULL)+
  geom_line() +
  facet_wrap(vars(view_category),  
             scales ="free",
             nrow = 3,
             strip.position = "top") +
  tag_facets(tag_pool = c("149","199","222", "232","169", "330"),
             position = list(x = .1, y = .76)) +
	scale_y_continuous(label = label_number_si()) +
  scale_x_continuous(label = label_number_si()) +
  labs(x = "View Count", y ="Number of Interactions", title ="Assessing Superbowl Ads Interactions",
       subtitle ="Interactions is defined by sum of \nlikes, dislikes and comments on a video",
       caption ="Number on Each Panel represents \nthe View To Interations Ratio of that view category") +
  theme_minimal() +
  theme(panel.grid.minor = element_blank(),
        strip.background = element_rect(colour = "black"),
        strip.placement = "inside",
        plot.title = element_text(face = "bold", size = 80, hjust = 0.5),
        plot.subtitle = element_text(size = 50, hjust = 0.5),
        panel.spacing = unit(1.4, "lines"),
        tagger.panel.tag.text = element_text(color = "blue", size = 30),
        plot.caption = element_text(color = "blue", size = 40, hjust =0.5),
        plot.caption.position = "panel",
        axis.text.x = NULL,
        axis.title.y = element_text(size = 50, hjust = 0.5, vjust = 1),
        axis.text = element_text(size = 25, lineheight = 10),
        strip.text.x = element_text(size = 30)) +
  scale_fill_viridis(discrete = T)
```


---

## Plot and text

.pull-left[
- Some text
- goes here
]
.pull-right[
```{r warning=FALSE, out.width="100%", fig.width=4, echo=FALSE}
# see how I changed out.width and fig.width from defaults
# to make the figure bigger

```
]

---

class: inverse, middle, center

# A new section...

---

## Tables

If you want to generate a table, make sure it is in the HTML format (instead of Markdown or other formats), e.g.,

```{r penguins-table, echo = FALSE}

```

---

## Images

```{r castle, echo = FALSE, out.width = "40%", fig.align = "center", fig.cap = "Image credit: Danielle Navarro, Percolate."}
include_graphics("img/watercolour_sys02_img32_percolate.jpg")
```

Or you can also include a full page image. See next slide.

---

background-image: url(img/watercolour_sys02_img32_percolate.jpg)

---

## Math Expressions

You can write LaTeX math expressions inside a pair of dollar signs, e.g. &#36;\alpha+\beta$ renders $\alpha+\beta$. You can use the display style with double dollar signs:

```
$$\bar{X}=\frac{1}{n}\sum_{i=1}^nX_i$$
```

$$\bar{X}=\frac{1}{n}\sum_{i=1}^nX_i$$

Limitations:

1. The source code of a LaTeX math expression must be in one line, unless it is inside a pair of double dollar signs, in which case the starting `$$` must appear in the very beginning of a line, followed immediately by a non-space character, and the ending `$$` must be at the end of a line, led by a non-space character;

1. There should not be spaces after the opening `$` or before the closing `$`.

1. Math does not work on the title slide (see [#61](https://github.com/yihui/xaringan/issues/61) for a workaround).

---

class: inverse, middle, center

# Wrap up

---

## Feeling adventurous?

- Want to find out more about `xaringan`? See https://slides.yihui.name/xaringan/#1.

- You are welcomed to use the default styling of the slides. In fact, that's what I expect majority of you will do. You will differentiate yourself with the content of your presentation.

- But some of you might want to play around with slide styling. The 
`xaringanthemer` provides some solutions for this that: https://pkg.garrickadenbuie.com/xaringanthemer.

- And if you want more bells and whistles, there is also `xaringanExtra`: https://pkg.garrickadenbuie.com/xaringanExtra.
