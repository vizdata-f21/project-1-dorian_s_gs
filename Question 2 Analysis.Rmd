---
title: "Question 2 Analysis"
output: html_document
---

```{r setup, include=FALSE}
library(tidyverse)
library(fs)
library(ggplot2)
library(dplyr)
library(ggridges)
library(forcats)
```

```{r}
superbowl<- read.csv("data/superbowl.csv")
```


```{r}
superbowl <- superbowl %>%
  mutate(ratio = like_count / (like_count + dislike_count))
```


```{r}

outliers <- boxplot.stats(superbowl$view_count)$out


superbowl_no_outliers <- superbowl %>%
  filter(!(view_count %in% outliers))


quantile(superbowl_no_outliers$view_count,na.rm = TRUE)
  
```

```{r official-outliers list}
boxplot.stats(superbowl$view_count)$out
  
```


```{r}
superbowl <-superbowl %>%
  mutate(view_category = case_when(
    view_count < 4000 ~ "Little",
    view_count >=4000 & view_count < 30000 ~ "Some",
     view_count >= 30000 &view_count < 90000 ~ "Moderate",
    view_count >= 90000 &view_count < 500000 ~ "Many",
    view_count >= 500000 &view_count < 10000000 ~ "High",
    TRUE ~ "Mega"
  ))
```


```{r}
superbowl%>%
  mutate(view_category = fct_relevel(
    view_category, "Mega", "High", "Many", "Moderate","Some","Little"
  ))%>%
  
ggplot(aes(x = ratio, y = view_category, fill = view_category)) +
  #scale_fill_continuous()
  geom_density_ridges(show.legend = FALSE)
```

```{r}
ggplot(data = superbowl, aes(x = ratio, fill = view_category)) +
  #scale_fill_continuous()
  facet_grid(view_category ~., scales = "free_y", space = "free_y") +
  geom_density(show.legend = FALSE) +
  #geom_text(aes(y = view_category, label = known_for), x = 2030, show.legend = FALSE, hjust = 0) +
  #geom_text(aes(label = profession), x = 1809, y = Inf, hjust = 1, vjust = 1, show.legend = FALSE) +
  theme(
    plot.title.position = "plot",
    plot.caption.position = "plot",
    plot.caption = element_text(hjust = 2), # manual hack
    strip.background = element_blank(),
    strip.text = element_blank(),
    axis.title.x = element_text(hjust = 0),
  )
```



