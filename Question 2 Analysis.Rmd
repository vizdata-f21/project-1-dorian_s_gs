---
title: "Question 2 Analysis"
output: html_document
---

```{r setup, include=FALSE}
library(tidyverse)
library(fs)
library(ggplot2)
library(dplyr)
library(ggridges)
library(forcats)
library(colorspace)
library(RColorBrewer)
```

```{r theme}
knitr::opts_chunk$set(
  fig.width = 8,    
  fig.asp = 0.618, 
  fig.align = "center",
  fig.retina = 3,    
  dpi = 300,         
  out.width = "60%"
)

ggplot2::theme_set(ggplot2::theme_minimal(base_size = 16))
```

```{r}
superbowl<- read.csv("data/superbowl.csv")
```


```{r}
superbowl <- superbowl %>%
  mutate(ratio = like_count / (like_count + dislike_count))
```


```{r}

outliers <- boxplot.stats(superbowl$view_count)$out


superbowl_no_outliers <- superbowl %>%
  filter(!(view_count %in% outliers))


quantile(superbowl_no_outliers$view_count,na.rm = TRUE)
  
```

```{r official-outliers list}
boxplot.stats(superbowl$view_count)$out
  
```


```{r}
superbowl <-superbowl %>%
  mutate(view_category = case_when(
    view_count < 4000 ~ "Little",
    view_count >=4000 & view_count < 30000 ~ "Some",
    view_count >= 30000 &view_count < 90000 ~ "Moderate",
    view_count >= 90000 &view_count < 500000 ~ "Many",
    view_count >= 500000 &view_count < 10000000 ~ "High",
    TRUE ~ "Mega"
  ))
```


```{r}
superbowl %>%
  mutate(view_category = fct_relevel(
    view_category, "Mega", "High", "Many", "Moderate","Some","Little"
  )) %>% 
  ggplot(aes(x = ratio, y = view_category, fill = view_category)) +
    geom_density_ridges(scale = 1, show.legend = FALSE) +
    coord_cartesian(xlim = c(.6, 1.05)) +
    scale_fill_discrete_sequential(palette = "Reds", order = c(6:1)) +
    scale_x_continuous(labels = scales::percent_format(accuracy = 1)) +
    scale_y_discrete(expand = expand_scale(mult = c(0.01, .4))) +
    labs(
      title = "Views on Youtube Superbowl Ads and Proportion of Likes",
      x = "Percentage of Likes",
      y = "Views",
      caption = "View count categories determined by\nquantiles from a standard distribution"
      ) +
    theme_ridges() +
    theme(
      plot.title = element_text(hjust = -0.3),
      plot.caption.position = "plot",
      plot.caption = element_text(size = 10, lineheight = 0.75, hjust = 0.1),
      strip.background = element_blank(),
      strip.text = element_blank(),
      axis.title.x = element_text(size = 16, hjust = 0.5),
      axis.title.y = element_text(size = 16, hjust = 0.5)
    )
```





